private static Set<String> getColumnNamesForTable(String db2TableName, TableMappingConfig.Mapping mapping) {
    if (db2TableName == null || mapping == null) return Collections.emptySet();

    Set<String> columnNames = new HashSet<>();

    // Handle DIRECT mapping
    if (mapping.getType() == MappingType.DIRECT && Objects.equals(db2TableName, mapping.getTable())) {
        columnNames.add(mapping.getColumn());
        columnNames.addAll(getColumnsForCondition(mapping.getCondition()));
    } 
    // Handle JSONB mapping
    else if (mapping.getType() == MappingType.JSONB) {
        for (TableMappingConfig.YBJsonAttributeMapping jsonAttributeMapping : mapping.getJsonbAttributeMappings()) {
            columnNames.addAll(getColumnNamesForTable(db2TableName, jsonAttributeMapping.getMapping().asMapping()));
        }
    }
    // Handle JSONB_MAP mapping
    else if (mapping.getType() == MappingType.JSONB_MAP) {
        for (TableMappingConfig.NestedDirectMapping mapKeyMapping : mapping.getMapKeyMappings()) {
            columnNames.addAll(getColumnNamesForTable(db2TableName, mapKeyMapping.asMapping()));
        }
    } 
    // Handle STRING_MAP mapping
    else if (mapping.getType() == MappingType.STRING_MAP) {
        for (TableMappingConfig.NestedDirectMapping mapKeyMapping : mapping.getMapKeyMappings()) {
            columnNames.addAll(getColumnNamesForTable(db2TableName, mapKeyMapping.asMapping()));
        }
        columnNames.addAll(getColumnNamesForTable(db2TableName, mapping.getStringMapValueMapping().asMapping()));
    }

    return columnNames;
}